---
updated: 23 September 2024
authors:
  - Richmond Sin
---

# @label(func) `process_html_tables`

## Overview

The `Process HTML Tables` node uses LLM to process the `content_body` column into a new `processed_table_content` column. The `processed_table_content` column is the content of the tables from the articles to be processed as separate documents to be ingested into the search index.

This function takes in the `filtered_data_rag` dataframe, the `temperature`, `max_tokens`, `seed`, and `n_completions` parameters. It process the table content in HTML format by performing the following steps:

1. Extracts the raw HTML from the 'content_body' column
2. Take in the raw HTML and pass it to the LLM to extract the table content in markdown format in a readable string.
3. Creates a new column `processed_table_content` to insert the response generated by the LLM.

The function returns a dataframe for further processing.

```python
def process_html_tables(
    filtered_data_rag: pd.DataFrame,
    temperature: int,
    max_tokens: int,
    n_completions: int,
    seed: int,
) -> pd.DataFrame:
```

## Parameters

: **`temperature`** (`int`):
This variable controls the randomness of the model’s output, with lower values making the output more deterministic and higher values adding more variability.
Refer to the [Data Catalog](https://github.com/Synapxe-DNA/healthhub-content-optimization/blob/main/content-optimization/conf/base/catalog.yml) for more information.

: **`max_tokens`** (`int`):
This specifies the maximum number of tokens (words or word-parts) that the model can generate in its response.
Refer to the [Data Catalog](https://github.com/Synapxe-DNA/healthhub-content-optimization/blob/main/content-optimization/conf/base/catalog.yml) for more information.

: **`n_completions`** (`int`):
This determines how many completions or outputs the model should generate in response to a given prompt.
Refer to the [Data Catalog](https://github.com/Synapxe-DNA/healthhub-content-optimization/blob/main/content-optimization/conf/base/catalog.yml) for more information.

: **`seed`** (`int`):
This variable is used to initialize the random number generator, ensuring that the model’s behavior is reproducible when the same seed is used.
Refer to the [Data Catalog](https://github.com/Synapxe-DNA/healthhub-content-optimization/blob/main/content-optimization/conf/base/catalog.yml) for more information.

## Returns

: **`processed_data_rag`**:
Returns a parquet files that have processed the table content of the articles. The file is saved at `data/03_primary/processed_data.parquet`. Refer to the `processed_data_rag` key in the [Data Catalog](https://github.com/Synapxe-DNA/healthhub-content-optimization/blob/main/content-optimization/conf/base/catalog.yml)
